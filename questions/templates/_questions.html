{% load comment %}
{% load mptt_tags %}
{% load user_content %}

{% get_comment_list for product as comments %}

{% if comments %}
    <a class="subtle" href="{% url ask_question product.slug %}">Ask A Question</a>

    <ul class="comments">
        {% recursetree comments %}
            <li class="comment">
                {% if not node.parent %}
                    {% question node %}
                {% else %}
                    {% answer node %}
                {% endif %}
                {% if not node.is_leaf_node %}
                    <ul class="comments">{{ children }}</ul>
                {% endif %}
            </li>
        {% endrecursetree %}
    </ul>
{% else %}
    <p class="subtle">Be the first to <a href="{% url ask_question product.slug %}">ask a question</a></p>
{% endif %}